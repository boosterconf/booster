<article class="inner">
  <div class="header-join">
    <h2>Update registration</h2>
  </div>
<% if admin? %>
<h2>Admin: Payment information for <%=h @registration.user.full_name %></h2>
  <p>
    User registered on: <%= @registration.created_at.to_date %>.
  </p>
  <p>
    Ticket price: NOK <%= @registration.price %>
  </p>

  <% if @registration.registration_complete %>
  <p>
    <strong>Payment is registered. </strong>
  </p>
  <% end %>

  <p>
    Before sending the invoice, make sure you have the right email. Users have been known to register more than once, with different email addresses.
  </p>
  <p>
    <strong>Invoice recipient email: <%= @registration.user.email %></strong>
  </p>

  <h4>Update payment information</h4>

  <%= form_for @registration do |f| %>
    <% unless @registration.free_ticket %>
    <div class="checkbox">
      <label>
        <%= f.check_box :manual_payment %>
        Invoice manually
      </label>
    </div>
      <div class="checkbox">
        <label>
          <%= f.check_box :invoiced %>
          Has been invoiced
        </label>
      </div>
    <% end %>
    <% unless @registration.registration_complete %>
      <div class="form-group">
        <%= hidden_field_tag :ticket_change %>
        <label for="ticket_type">Ticket type</label>
        <%= f.collection_select :ticket_type_id, TicketType.all, :id, :name, {},  class: 'form-control admin' %>
    </div>
    <div class="form-group">
      <label for="invoice_description">Invoice information</label>
      <%= f.text_area :invoice_description, :rows => 4, class: 'form-control' %>
    </div>
    <div class="checkbox">
      <label>
        <%= f.check_box :includes_dinner %>
        Participates at the dinner
      </label>
    </div>
    <% end %>
    <div class="form-group">
      <label for="comments">Admin comments</label>
      <%= f.text_area :comments, :rows => 5, class: 'form-control' %>
    </div>
    <div class="form-group">
      <label for="payment_reference">Payment reference</label>
      <%= f.text_field :payment_reference, class: 'form-control' %>
    </div>
    <div class="form-group">
      <label for="paid_amount">Paid amount</label>
      <%= f.text_field :paid_amount, class: 'form-control' %>
    </div>
    <div class="checkbox">
      <label>
        <%= f.check_box :registration_complete %>
          Registration is confirmed
      </label>
    </div>
    <div class="form-actions">
      <%= f.submit "Update payment", :class => "btn btn-primary" %>
    </div>
  <% end %>

</div>
<% end %>
</article>
